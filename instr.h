#include <stdint.h>
#include "flags.h"
#include <capstone/capstone.h>
#include <capstone/x86.h>

#ifndef INSTR_H
#define INSTR_H

#define STACK_BOTTOM 0xFFF00000
#define STACK_TOP (STACK_BOTTOM - 0x22000)

int initialize();
int dispatcher(char * mnemonic, cs_insn * insn);
int aaa_i(cs_insn *insn);
int aad_i(cs_insn *insn);
int aam_i(cs_insn *insn);
int aas_i(cs_insn *insn);
int adc_i(cs_insn *insn);
int add_i(cs_insn *insn);
int and_i(cs_insn *insn);
int arpl_i(cs_insn *insn);
int bound_i(cs_insn *insn);
int bsf_i(cs_insn *insn);
int bsr_i(cs_insn *insn);
int bt_i(cs_insn *insn);
int btc_i(cs_insn *insn);
int btr_i(cs_insn *insn);
int bts_i(cs_insn *insn);
int call_i(cs_insn *insn);
int cbw_i(cs_insn *insn);
int cwde_i(cs_insn *insn);
int clc_i(cs_insn *insn);
int cld_i(cs_insn *insn);
int cli_i(cs_insn *insn);
int clts_i(cs_insn *insn);
int cmc_i(cs_insn *insn);
int cmp_i(cs_insn *insn);
int cmps_i(cs_insn *insn);
int cmpsb_i(cs_insn *insn);
int cmpsw_i(cs_insn *insn);
int cmpsd_i(cs_insn *insn);
int cwd_i(cs_insn *insn);
int cdq_i(cs_insn *insn);
int daa_i(cs_insn *insn);
int das_i(cs_insn *insn);
int dec_i(cs_insn *insn);
int div_i(cs_insn *insn);
int enter_i(cs_insn *insn);
int hlt_i(cs_insn *insn);
int idiv_i(cs_insn *insn);
int imul_i(cs_insn *insn);
int in_i(cs_insn *insn);
int inc_i(cs_insn *insn);
int ins_i(cs_insn *insn);
int insb_i(cs_insn *insn);
int insw_i(cs_insn *insn);
int insd_i(cs_insn *insn);
int inter_i(cs_insn *insn);
int int_i(cs_insn *insn);
int into_i(cs_insn *insn);
int iret_i(cs_insn *insn);
int iretd_i(cs_insn *insn);
int jcc_i(cs_insn *insn);
int jmp_i(cs_insn *insn);
int lahf_i(cs_insn *insn);
int lar_i(cs_insn *insn);
int lea_i(cs_insn *insn);
int leave_i(cs_insn *insn);
int lgdt_i(cs_insn *insn);
int lidt_i(cs_insn *insn);
int lgs_i(cs_insn *insn);
int lss_i(cs_insn *insn);
int lds_i(cs_insn *insn);
int les_i(cs_insn *insn);
int lfs_i(cs_insn *insn);
int lmsw_i(cs_insn *insn);
int lock_i(cs_insn *insn);
int lods_i(cs_insn *insn);
int lodsb_i(cs_insn *insn);
int lodsw_i(cs_insn *insn);
int lodsd_i(cs_insn *insn);
int loop_i(cs_insn *insn);
int lsl_i(cs_insn *insn);
int ltr_i(cs_insn *insn);
int movs_i(cs_insn *insn);
int movsb_i(cs_insn *insn);
int movsw_i(cs_insn *insn);
int movsd_i(cs_insn *insn);
int movsx_i(cs_insn *insn);
int movzx_i(cs_insn *insn);
int mul_i(cs_insn *insn);
int neg_i(cs_insn *insn);
int nop_i(cs_insn *insn);
int not_i(cs_insn *insn);
int or_i(cs_insn *insn);
int out_i(cs_insn *insn);
int outs_i(cs_insn *insn);
int outsb_i(cs_insn *insn);
int outsw_i(cs_insn *insn);
int outsd_i(cs_insn *insn);
int pop_i(cs_insn *insn);
int popa_i(cs_insn *insn);
int popad_i(cs_insn *insn);
int popf_i(cs_insn *insn);
int popfd_i(cs_insn *insn);
int push_i(cs_insn *insn);
int pusha_i(cs_insn *insn);
int pushad_i(cs_insn *insn);
int pushf_i(cs_insn *insn);
int pushfd_i(cs_insn *insn);
int rcl_i(cs_insn *insn);
int rcr_i(cs_insn *insn);
int rol_i(cs_insn *insn);
int ror_i(cs_insn *insn);
int rep_i(cs_insn *insn);
int repe_i(cs_insn *insn);
int repz_i(cs_insn *insn);
int repne_i(cs_insn *insn);
int repnz_i(cs_insn *insn);
int ret_i(cs_insn *insn);
int sahf_i(cs_insn *insn);
int sal_i(cs_insn *insn);
int sar_i(cs_insn *insn);
int shl_i(cs_insn *insn);
int shr_i(cs_insn *insn);
int sbb_i(cs_insn *insn);
int scas_i(cs_insn *insn);
int scasb_i(cs_insn *insn);
int scasw_i(cs_insn *insn);
int scasd_i(cs_insn *insn);
int setcc_i(cs_insn *insn);
int sgdt_i(cs_insn *insn);
int sidt_i(cs_insn *insn);
int shld_i(cs_insn *insn);
int shrd_i(cs_insn *insn);
int smsw_i(cs_insn *insn);
int stc_i(cs_insn *insn);
int std_i(cs_insn *insn);
int sti_i(cs_insn *insn);
int stos_i(cs_insn *insn);
int stosb_i(cs_insn *insn);
int stosw_i(cs_insn *insn);
int stosd_i(cs_insn *insn);
int str_i(cs_insn *insn);
int sub_i(cs_insn *insn);
int test_i(cs_insn *insn);
int verr_i(cs_insn *insn);
int verw_i(cs_insn *insn);
int wait_i(cs_insn *insn);
int xchg_i(cs_insn *insn);
int xlat_i(cs_insn *insn);
int xlatb_i(cs_insn *insn);
int xor_i(cs_insn *insn);
int mov_i(cs_insn *insn);
int ja_i(cs_insn *insn);
int jae_i(cs_insn *insn);
int jb_i(cs_insn *insn);
int jbe_i(cs_insn *insn);
int jc_i(cs_insn *insn);
int jcxz_i(cs_insn *insn);
int je_i(cs_insn *insn);
int jg_i(cs_insn *insn);
int jge_i(cs_insn *insn);
int jl_i(cs_insn *insn);
int jle_i(cs_insn *insn);
int jna_i(cs_insn *insn);
int jnae_i(cs_insn *insn);
int jnb_i(cs_insn *insn);
int jnbe_i(cs_insn *insn);
int jnc_i(cs_insn *insn);
int jne_i(cs_insn *insn);
int jng_i(cs_insn *insn);
int jnge_i(cs_insn *insn);
int jnl_i(cs_insn *insn);
int jnle_i(cs_insn *insn);
int jno_i(cs_insn *insn);
int jnp_i(cs_insn *insn);
int jns_i(cs_insn *insn);
int jo_i(cs_insn *insn);
int jp_i(cs_insn *insn);
int jpo_i(cs_insn *insn);
int js_i(cs_insn *insn);
int lcall_i(cs_insn *insn);
int lldt_i(cs_insn *insn);
int loope_i(cs_insn *insn);
int loopne_i(cs_insn *insn);
int loopnz_i(cs_insn *insn);
int loopz_i(cs_insn *insn);
int seta_i(cs_insn *insn);
int setae_i(cs_insn *insn);
int setb_i(cs_insn *insn);
int setbe_i(cs_insn *insn);
int setc_i(cs_insn *insn);
int sete_i(cs_insn *insn);
int setg_i(cs_insn *insn);
int setge_i(cs_insn *insn);
int setl_i(cs_insn *insn);
int setle_i(cs_insn *insn);
int setna_i(cs_insn *insn);
int setnae_i(cs_insn *insn);
int setnb_i(cs_insn *insn);
int setnbe_i(cs_insn *insn);
int setnc_i(cs_insn *insn);
int setne_i(cs_insn *insn);
int setng_i(cs_insn *insn);
int setnge_i(cs_insn *insn);
int setnl_i(cs_insn *insn);
int setnle_i(cs_insn *insn);
int setno_i(cs_insn *insn);
int setnp_i(cs_insn *insn);
int setns_i(cs_insn *insn);
int seto_i(cs_insn *insn);
int setp_i(cs_insn *insn);
int setpe_i(cs_insn *insn);
int setpo_i(cs_insn *insn);
int sets_i(cs_insn *insn);
int jpe_i(cs_insn *insn);

uint32_t reg_val(int reg_id);
uint32_t eff_addr(x86_op_mem m);
uint32_t pow_i(uint32_t b, uint32_t exp);
void write16(uint32_t addr, uint16_t value);
void write32(uint32_t addr, uint32_t value);
uint16_t read16(uint32_t addr);
uint32_t read32(uint32_t addr);

#endif